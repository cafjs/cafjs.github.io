<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>caf_redis/plug_checkpoint - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-caf_redis_gen_redis_plug.html">caf_redis/gen_redis_plug</a><ul class='methods'><li data-type='method'><a href="module-caf_redis_gen_redis_plug.html#__ca_doLuaOp__">__ca_doLuaOp__</a></li><li data-type='method'><a href="module-caf_redis_gen_redis_plug.html#__ca_flush__">__ca_flush__</a></li><li data-type='method'><a href="module-caf_redis_gen_redis_plug.html#__ca_getClientRedis__">__ca_getClientRedis__</a></li><li data-type='method'><a href="module-caf_redis_gen_redis_plug.html#__ca_initClient__">__ca_initClient__</a></li><li data-type='method'><a href="module-caf_redis_gen_redis_plug.html#__ca_ping__">__ca_ping__</a></li><li data-type='method'><a href="module-caf_redis_gen_redis_plug.html#__ca_queue__">__ca_queue__</a></li></ul></li><li><a href="module-caf_redis_main.html">caf_redis/main</a></li><li><a href="module-caf_redis_plug_checkpoint.html">caf_redis/plug_checkpoint</a><ul class='methods'><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#checkBits">checkBits</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#clearBits">clearBits</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#createMap">createMap</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#deleteMap">deleteMap</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#deleteState">deleteState</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#getCache">getCache</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#getState">getState</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#grabLease">grabLease</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#grabNodeLease">grabNodeLease</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#listNodes">listNodes</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#publishPubSub">publishPubSub</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#readMap">readMap</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#renewLeases">renewLeases</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#renewNodeLease">renewNodeLease</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#setBits">setBits</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#subscribeMap">subscribeMap</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#subscribePubSub">subscribePubSub</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#unsubscribeMap">unsubscribeMap</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#unsubscribePubSub">unsubscribePubSub</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#updateCache">updateCache</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#updateMap">updateMap</a></li><li data-type='method'><a href="module-caf_redis_plug_checkpoint.html#updateState">updateState</a></li></ul></li></ul><h3>Externals</h3><ul><li><a href="external-caf_components_gen_plug.html">caf_components/gen_plug</a></li></ul><h3>Namespaces</h3><ul><li><a href="caf_redis_util_builder.html">caf_redis/util_builder</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">caf_redis/plug_checkpoint</h1>
    

    




<section>

<header>
    
        
            
        
    
</header>

<article>
    
        <div class="container-overview">
        
            
                <div class="description usertext"><p>A plug  to access an external checkpointing service that supports
LUA scripting (Redis version &gt;= 2.6).</p>
<p>The goal is to enable full pipelining of requests
while still guaranteeing  ownership of leases during operations.</p>
<p>Lua scripts are executed atomically by the server, and therefore, we can
combine the check and the update in the same script.</p>
<p>We also implement coalescing of state updates across different CAs in a
single script, to amortize the setup cost of LUA with several
updates.</p>
<p>This improves dramatically Redis throughput, and also reduces
client overhead.</p>
<p>The drawback is an increase in latency when the system is
not under heavy load, and we need a <code>cron</code> to bound that increase.</p>
<p>Typical coalescing config  values for a fast server are a maximum
of 10 requests or 10 extra msec. Note that cron scheduling is not very
accurate under load, and we also need a limit on the number of
pending requests.</p></div>
            

            
                




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line18">line 18</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>
































            
        
        </div>
    

    
        <h3 class="subsection-title">Extends</h3>

        


    <ul>
        <li><a href="module-caf_redis_gen_redis_plug.html">module:caf_redis/gen_redis_plug</a></li>
    </ul>


    

    

    
    
    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="checkBits"><span class="type-signature"></span>checkBits<span class="signature">(bitfieldName, bits, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line694">line 694</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Check bits in a bitfield. If any is not set it returns false.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>bitfieldName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the bitfield.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>bits</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            

            

            <td class="description last"><p>The index of bits to be checked.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to return true if all set or null
otherwise (or an error).</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="clearBits"><span class="type-signature"></span>clearBits<span class="signature">(bitfieldName, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line678">line 678</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Clear all bits in a bitfield.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>bitfieldName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the bitfield.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to notify an error.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="createMap"><span class="type-signature"></span>createMap<span class="signature">(mapName, initialValue, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line711">line 711</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Creates a Map or returns the contents of an existing one.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>mapName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the map.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>initialValue</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object.&lt;string, <a href="global.html#jsonType">jsonType</a>></span>
|

<span class="param-type">null</span>


            
            </td>

            

            

            <td class="description last"><p>An optional
initial value. This value is ignored if the map was already
initialized.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback with the contents of the map.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="deleteMap"><span class="type-signature"></span>deleteMap<span class="signature">(mapName, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line734">line 734</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Deletes a Map.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>mapName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the map.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback with an error  or null.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="deleteState"><span class="type-signature"></span>deleteState<span class="signature">(id, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line478">line 478</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Removes the state of a CA in the checkpointing service.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>An identifier for the CA.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to notify an error deleting
or its succesful completion if the argument is a falsy.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="getCache"><span class="type-signature"></span>getCache<span class="signature">(key, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line602">line 602</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Looks up a cache entry.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The cache entry key.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback returning the value (or null).</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="getState"><span class="type-signature"></span>getState<span class="signature">(id, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line496">line 496</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Gets the state of a  CA from the checkpointing service.</p>
<p>Note that only the current (lease) owner can read this state.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>An identifier for the CA.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>A callback to notify an
error getting the state or (in a second argument) the serialized
state of that CA.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="grabLease"><span class="type-signature"></span>grabLease<span class="signature">(id, leaseTimeout, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line525">line 525</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Grabs a lease that guarantees exclusive ownership of a CA by this
node.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>An identifier for the CA.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>leaseTimeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"><p>Duration of the lease in seconds.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback with optional
(error) argument containing the current owner in a
<code>remoteNode:string</code> error field, if we failed to acquire the lease.
Null error argument if we succeeded.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="grabNodeLease"><span class="type-signature"></span>grabNodeLease<span class="signature">(allPublicNodeIds, privateNodeId, leaseTimeout, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line1005">line 1005</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Picks an available public nodeId for this process and binds it with a
lease to the private node identifier.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>allPublicNodeIds</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>


            
            </td>

            

            

            <td class="description last"><p>A list of candidates for a
public nodeId for this process.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>privateNodeId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>A private unique identifier for the
current node.js process.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>leaseTimeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"><p>Duration of the lease in seconds.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>A callback with
an error if we cannot renew lease or the new external nodeId.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="listNodes"><span class="type-signature"></span>listNodes<span class="signature">(allPublicNodeIds, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line1039">line 1039</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Lists status of  nodes registered with this redis instance.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>allPublicNodeIds</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>
|

<span class="param-type">null</span>


            
            </td>

            

            

            <td class="description last"><p>A list of
public nodeIds that we are interested on, or null if we want them
all.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>A
callback with an error or an object with external nodeIds to
private nodeIds (containing only the ones in use).</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="publishPubSub"><span class="type-signature"></span>publishPubSub<span class="signature">(topic, message, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line953">line 953</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Publishes a message to a channel using the  PubSub service.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>topic</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The channel name.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>message</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The message to be published.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to return a publish error.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="readMap"><span class="type-signature"></span>readMap<span class="signature">(mapName, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line752">line 752</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Reads all the contents of a map.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>mapName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the map.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback with an error if it does not exist or
an object (second argument) of type caf.changes :
{version:number, remove:[],
add:Array<Object> (i.e., flattened key value pairs)}</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="renewLeases"><span class="type-signature"></span>renewLeases<span class="signature">(ids, leaseTimeout, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line557">line 557</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Renews a list of leases currently owned by this node.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>ids</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>


            
            </td>

            

            

            <td class="description last"><p>A list of identifiers for local CAs.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>leaseTimeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"><p>Duration of the lease in seconds.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>A callback with
either an error (first) argument or a (second) argument with a list
of CA Ids that we failed to renew.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="renewNodeLease"><span class="type-signature"></span>renewNodeLease<span class="signature">(privateNodeId, leaseTimeout, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line971">line 971</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Renews a lease associated with this node.js process.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>privateNodeId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>A private unique identifier for the
current node.js process.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>leaseTimeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"><p>Duration of the lease in seconds.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>A callback with
an error if we cannot renew lease.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="setBits"><span class="type-signature"></span>setBits<span class="signature">(bitfieldName, bits, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line664">line 664</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Sets bits in a bitfield.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>bitfieldName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the bitfield.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>bits</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            

            

            <td class="description last"><p>The index of bits to be set.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to notify an error.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="subscribeMap"><span class="type-signature"></span>subscribeMap<span class="signature">(mapName, handler, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line839">line 839</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Listens to Map updates.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>mapName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the map.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>handler</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A handler to listen to updates or errors.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback with an error or null.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="subscribePubSub"><span class="type-signature"></span>subscribePubSub<span class="signature">(topic, deliverMsgF, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line918">line 918</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Subscribes to a channel in the PubSub service.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>topic</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The channel name.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>deliverMsgF</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>Handler of
received messages. First argument is the topic, second the message.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to return a subscription error.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="unsubscribeMap"><span class="type-signature"></span>unsubscribeMap<span class="signature">(mapName, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line871">line 871</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Unregisters a Map update listener.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>mapName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the map.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback with an error or null.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="unsubscribePubSub"><span class="type-signature"></span>unsubscribePubSub<span class="signature">(topic, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line938">line 938</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Unsubscribes to a channel in the PubSub service.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>topic</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The channel name.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to return a subscription error.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="updateCache"><span class="type-signature"></span>updateCache<span class="signature">(key, value, timeout, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line624">line 624</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Updates a cache entry.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>key</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The cache entry key.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>value</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The cache entry value.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>timeout</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"><p>An expire time in seconds.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to return an error.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="updateMap"><span class="type-signature"></span>updateMap<span class="signature">(mapName, changes, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line777">line 777</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Updates a Map.</p>
<p>The type changesType is a normalized update (no duplicated keys) of
the form:</p>
<pre><code>{version: number, remove : Array.&lt;string&gt;, add : Array&lt;Object&gt;}
</code></pre>
<p>It publishes in a channel with id <code>mapName</code> the JSON-encoded
<code>changes</code> contents.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>mapName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the map.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>changes</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#changesType">changesType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A delta with changes.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback with an error if it does not exist or
the number of subscribed clients.</p></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="updateState"><span class="type-signature"></span>updateState<span class="signature">(id, newValue, cb0)</span><span class="type-signature"></span></h4>

    




<dl class="details">

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="plug_checkpoint.js.html">plug_checkpoint.js</a>, <a href="plug_checkpoint.js.html#line459">line 459</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Updates the state of a CA in the checkpointing service.</p>
</div>











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>id</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>An identifier for the CA.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>newValue</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>A serialized new state for this CA.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cb0</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#cbType">cbType</a></span>


            
            </td>

            

            

            <td class="description last"><p>A callback to notify of an error updating
or succesful completion if falsy argument.</p></td>
        </tr>

    
    </tbody>
</table>



















        
    

    

    
</article>

</section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Wed Feb 10 2021 16:53:44 GMT-0800 (Pacific Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>