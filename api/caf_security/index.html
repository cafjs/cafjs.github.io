<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Home - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-caf_security_aggregates.html">caf_security/aggregates</a><ul class='methods'><li data-type='method'><a href="module-caf_security_rules.html">computeRuleId</a></li><li data-type='method'><a href="module-caf_security_rules.html">isAuthorized</a></li><li data-type='method'><a href="module-caf_security_aggregates.html">newAggregateRule</a></li><li data-type='method'><a href="module-caf_security_rules.html">newRuleEngine</a></li></ul></li><li><a href="module-caf_security_main.html">caf_security/main</a></li><li><a href="module-caf_security_plug_ca_security.html">caf_security/plug_ca_security</a></li><li><a href="module-caf_security_plug_security.html">caf_security/plug_security</a><ul class='methods'><li data-type='method'><a href="module-caf_security_plug_security.html#__ca_attenuateToken__">__ca_attenuateToken__</a></li><li data-type='method'><a href="module-caf_security_plug_security.html#__ca_authenticate__">__ca_authenticate__</a></li><li data-type='method'><a href="module-caf_security_plug_security.html#__ca_blockCreate__">__ca_blockCreate__</a></li><li data-type='method'><a href="module-caf_security_plug_security.html#__ca_pulse__">__ca_pulse__</a></li><li data-type='method'><a href="module-caf_security_plug_security.html#__ca_quotaCheck__">__ca_quotaCheck__</a></li><li data-type='method'><a href="module-caf_security_plug_security.html#__ca_quotaRenew__">__ca_quotaRenew__</a></li><li data-type='method'><a href="module-caf_security_plug_security.html#__ca_verifyToken__">__ca_verifyToken__</a></li></ul></li><li><a href="module-caf_security_proxy_security.html">caf_security/proxy_security</a><ul class='methods'><li data-type='method'><a href="module-caf_security_proxy_security.html#addRule">addRule</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#attenuateToken">attenuateToken</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#computeRuleId">computeRuleId</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#getAppName">getAppName</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#getCallerFrom">getCallerFrom</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#isAuthorized">isAuthorized</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#listRules">listRules</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#newAggregateRule">newAggregateRule</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#newSimpleRule">newSimpleRule</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#removeRule">removeRule</a></li><li data-type='method'><a href="module-caf_security_proxy_security.html#verifyToken">verifyToken</a></li></ul></li><li><a href="module-caf_security_rules.html">caf_security/rules</a><ul class='methods'><li data-type='method'><a href="module-caf_security_rules.html">computeRuleId</a></li><li data-type='method'><a href="module-caf_security_rules.html">isAuthorized</a></li><li data-type='method'><a href="module-caf_security_rules.html">newRuleEngine</a></li><li data-type='method'><a href="module-caf_security_rules.html">newSimpleRule</a></li></ul></li><li><a href="module-caf_security_tokens.html">caf_security/tokens</a><ul class='methods'><li data-type='method'><a href="module-caf_security_tokens.html">decode</a></li><li data-type='method'><a href="module-caf_security_tokens.html">lessOrEqual</a></li><li data-type='method'><a href="module-caf_security_tokens.html">meet</a></li><li data-type='method'><a href="module-caf_security_tokens.html">newPayload</a></li><li data-type='method'><a href="module-caf_security_tokens.html">satisfyACL</a></li><li data-type='method'><a href="module-caf_security_tokens.html">sign</a></li><li data-type='method'><a href="module-caf_security_tokens.html">similar</a></li><li data-type='method'><a href="module-caf_security_tokens.html">validate</a></li><li data-type='method'><a href="module-caf_security_tokens.html">validExtendedNobody</a></li><li data-type='method'><a href="module-caf_security_tokens.html">validUsername</a></li></ul></li><li><a href="module-caf_security_utils.html">caf_security/utils</a><ul class='methods'><li data-type='method'><a href="module-caf_security_utils.html">accountsSession</a></li><li data-type='method'><a href="module-caf_security_utils.html">loadKey</a></li></ul></li></ul><h3>Externals</h3><ul><li><a href="external-caf_components_gen_plug.html">caf_components/gen_plug</a></li><li><a href="external-caf_components_gen_plug_ca.html">caf_components/gen_plug_ca</a></li><li><a href="external-caf_components_gen_proxy.html">caf_components/gen_proxy</a></li><li><a href="external-caf_sharing.html">caf_sharing</a></li><li><a href="external-caf_sharing_AggregateMap.html">caf_sharing/AggregateMap</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    

    



    


    <section class="package">
        <h3>caf_security 0.4.1</h3>		
    </section>









    



    <section class="readme usertext">
        <article><h1>Caf.js</h1>
<p>Co-design permanent, active, stateful, reliable cloud proxies with your web app or gadgets.</p>
<p>See https://www.cafjs.com</p>
<h2>Security Library</h2>
<p><a href="https://travis-ci.org/cafjs/caf_security"><img src="https://travis-ci.org/cafjs/caf_security.svg?branch=master" alt="Build Status"></a></p>
<p>This repository contains a <code>Caf.js</code> library to add security checks.</p>
<p>The goal is to help application writers to support collaborative multi-tenancy within one app.</p>
<p><code>Caf.js</code> runs each application in a separate process, and the framework is under the control of the application writer. Therefore, the service provider, or other applications, should not trust those processes.</p>
<p>Also, we do not expect applications to run untrusted code in the Cloud. However, <code>Caf.js</code> tries very hard to minimize the impact of programming mistakes, such as trusting user input too much.</p>
<h3>Naming</h3>
<p>It's all in the name.</p>
<p>Borrowing ideas from SDSI (Rivest&amp;Lampson'96), we use local namespaces that can be globally identified because the <code>owner</code> of the namespace has a unique name that we can authenticate. For example, the hash of a public key can be assumed to be unique, or a username in our <code>accounts</code> service, since this service also has a public/private key pair.</p>
<p>And this allow us to <strong>link</strong> local namespaces in a robust manner. Similar to a symbolic link in a sensible file system, a name in a local namespace can refer to a named resource in a different local namespace.</p>
<p>Moreover, a local name can refer to a group of resources, similar to referring to a sub-directory with symbolic links. Also, a resource could have many names, i.e., names become user-friendly tags that help us find resources.</p>
<p>Given a local name, how do we find its resources? By computing the transitive closure: start with local resources or referrals, both matching the target name; then, follow links, and keep adding reachable resources.</p>
<p>What resources are registered in a <code>Caf.js</code> local namespace? <strong>Everything</strong></p>
<ul>
<li>CA:  using a  <code>caOwner-caLocalName</code> convention.</li>
<li><code>SharedMap</code>: scoped by the CA that owns it, i.e.,
<code>caOwner-caLocalName-mapLocalName</code>.</li>
<li>Private pub/sub channels: to enforce that only one CA can publish, i.e.,  <code>caOwner-caLocalName-channelLocalName</code></li>
<li>Application: named after <code>appPublisher-appLocalName</code>.</li>
<li>...</li>
</ul>
<p>Two practical considerations:</p>
<ul>
<li>
<p>We sometimes use resource names as hostnames and, we need to
restrict characters to ASCII letters (lower case) and numbers (see RFC 1123).</p>
</li>
<li>
<p>We can use the same <code>caLocalName</code> in different applications. Therefore, we
may need to qualify a CA name with its app name to make it globally unique. Since applications do not trust each other, this is rarely needed.</p>
</li>
</ul>
<h3>Authorization</h3>
<p>A core <code>Caf.js</code> abstraction is a trusted bus internal to an application. CAs interact with each other using this bus, and the bus guarantees that every request is authenticated by the source CA.</p>
<p>This allows the destination CA to grant or deny the request based on the method invoked and the caller. Also, application code has access to the caller's name, and it can impose extra requirements based on the call arguments.</p>
<p><code>Caf.js</code> naming helps us describe access policy. Explicit ownership in the name makes it easier to allow any CA from a trusted owner, or CAs with the same owner. Names naturally support groups, and by linking them, we can delegate the creation of a group to third parties. We can also group methods, further simplifying policy description.</p>
<p>Linked local namespaces are implemented with <code>AggregateMaps</code> (see <a href="external-caf_sharing_AggregateMap.html">external:caf_sharing/AggregateMap</a>) not with certificates as in SDSI. These distributed data structures can only be written by its owner, and the trusted bus that propagates updates to replicas enforces that property. This has important advantages:</p>
<ul>
<li>Owners do not need to manage private keys.</li>
<li>Discovery is efficient, and transparently managed by the framework.</li>
<li>Revocation is fast (milliseconds).</li>
<li>Changes to an <code>AggregateMap</code> respect <em>Writer Atomicity</em>, <em>Readers Isolation</em>, <em>Fairness</em>, and monotonic read consistency (see <a href="external-caf_sharing.html">external:caf_sharing</a>), eliminating dangerous transients when policy changes.</li>
</ul>
<h3>Authentication</h3>
<p>A client always interacts with its CA using a mutually-authenticated secure channel. The challenge is how to provide single sign-on to multiple app CAs, when apps are not equally trusted. Client credentials used with one CA could be abused to access a more trusted CA.</p>
<p>We use JSON Web Tokens (JWT) signed by a third-party service, i.e., <code>accounts</code>,
to weaken authentication credentials. Tokens can be scoped to a local name within an application. Local names could belong to other namespaces, federating authentication. A simple mechanism to weaken tokens enables a privileged CA to manage tokens on behalf of a client. See <a href="module-caf_security_tokens.html">module:caf_security/tokens</a>.</p>
<p>Password-based authentication with the <code>accounts</code> service is based on SRP. SRP derives a strong shared secret from a weak one, while being immune to man in the middle attacks. We use this strong secret to encrypt the JSON Web Token.</p></article>
    </section>






    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Wed Feb 10 2021 16:53:45 GMT-0800 (Pacific Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>